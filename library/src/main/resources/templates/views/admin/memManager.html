<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>TITLE</title>
</head>
<body>

<div th:replace="~{common/navbar :: navbar}"></div>
	<div th:replace="~{common/adminSymbol :: symbol}"></div>

	<div class="container-fluid">
		<div class="row">
			<div th:replace="~{common/adminbar :: sidebar}"></div>
			
			<main class="col-md-10 ms-sm-auto col-lg-10 px-md-4" style="padding-top: 30px;">
				<div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
					<h1 class="h2">관리자 페이지 - 부서관리</h1>
				</div>
				<br><br><br>
				
				
				
				<ul class="nav nav-pills justify-content-center">
					<li class="nav-item">
						<a class="nav-link" aria-current="page" href="memConsumer.adm">회원</a>
					</li>
					<li class="nav-item">
						<a class="nav-link active" href="memManager.adm">관리자</a>
					</li>
				</ul>
				
				
				<h2>관리자리스트</h2>
				
				
				<form class="d-flex" id="searchForm" role="search" style="float: right;">
			    	<input type="hidden" id="path" name="path" value="memConsumer"/>
			    	<!-- <select id="category" name="category">
			    		<option value="memNo">회원번호</option>
			    		<option value="memId">아이디</option>
			    		<option value="memName">이름</option>
			    		<option value="memPhone">전화번호</option>
			    	</select> -->
					<input class="form-control me-2 w-100" type="search" placeholder="Search" id="inputSearch" aria-label="Search" >
					<button class="btn btn-outline-success" id="searchBtn" type="button">Search</button>
				</form>
				
				<br><br>
				
				<table class="table text-center">
					<thead>
						<tr style="border-top: 2px solid black;">
							<th scope="col" style="border-right: 1px solid gainsboro; background-color: #F8F8F8;"></th>
							<th scope="col" style="border-right: 1px solid gainsboro; background-color: #F8F8F8;">회원번호</th>
							<th scope="col" style="border-right: 1px solid gainsboro; background-color: #F8F8F8;">아이디</th>
							<th scope="col" style="border-right: 1px solid gainsboro; background-color: #F8F8F8;">이름</th>
							<th scope="col" style="border-right: 1px solid gainsboro; background-color: #F8F8F8;">전화번호</th>
							<th scope="col" style="border-right: 1px solid gainsboro; background-color: #F8F8F8;">이메일</th>
							<th scope="col" style="border-right: 1px solid gainsboro; background-color: #F8F8F8;">활성화상태</th>
							<th scope="col" style="border-right: 1px solid gainsboro; background-color: #F8F8F8;">회원등급</th>
							<th scope="col" style="background-color: #F8F8F8;">가입날짜</th>
							
						</tr>
					</thead>
					<tbody>
						<tr th:each="m : ${m}">
							<td scope="col" style="border-right: 1px solid gainsboro;"><input class="form-check-input" type="checkbox" name="checked" id="flexCheckDefault"></td>
							<td scope="col" style="border-right: 1px solid gainsboro;"><input type="hidden" name="memNo" th:value="${m.memNo}"/>[[${m.memNo}]]</td>
							<td scope="col" style="border-right: 1px solid gainsboro;"><input type="hidden" name="memId" th:value="${m.memId}"/>[[${m.memId}]]</td>
							<td scope="col" style="border-right: 1px solid gainsboro;"><input type="hidden" th:value="${m.memName}" name="memName" style="width: 100%">[[${m.memName}]]</td>
							<td scope="col" style="border-right: 1px solid gainsboro;"><input type="hidden" th:value="${m.memPhone}" name="memPhone" style="width: 100%">[[${m.memPhone}]]</td>
							<td scope="col" style="border-right: 1px solid gainsboro;"><input type="hidden" th:value="${m.memEmail}" name="memEmail" style="width: 100%">[[${m.memEmail}]]</td>
							<td scope="col" style="border-right: 1px solid gainsboro;"><input type="hidden" th:value="${m.memActive}" name="memActive" style="width: 100%">[[${m.memActive}]]</td>
							<td scope="col" style="border-right: 1px solid gainsboro;"><input type="hidden" th:value="${m.memActive}" name="memActive" style="width: 100%">[[${m.memGrade}]]</td>
							<td scope="col"><input type="hidden" th:value="${m.memActive}" name="memActive" style="width: 100%">[[${m.memEnrollDate}]]</td>
						</tr>
					</tbody>
				</table>
				<br><br><br>
				
				<div class="d-grid gap-2 d-md-flex justify-content-md-end">
					<button class="btn" style="background-color: #F8F8F8;" id="gradeChange" type="button">회원등급변경</button>
					<button class="btn btn-danger me-md-1" id="offBtn" type="button">계정 비활성화</button>
					<button class="btn btn-primary me-md-1" id="onBtn" type="button">계정 활성화</button>
				</div>
				<br><br><br>
				
				<div style="margin-bottom:100px; margin-top: 50px;">
			       	<ul class="pagination justify-content-center" th:with="loc=${loc}">
			            <li class="page-item">
			            	<a class="page-link" th:href="@{${loc}(page=${pi.currentPage-1})}" aria-label="Previous">
			            		<span aria-hidden="true">&laquo;</span>
			              	</a>
			            </li>
			            	<li class="page-item" th:each="p : ${#numbers.sequence(pi.startPage, pi.endPage)}"><a class="page-link" th:href="@{${loc}(page=${p})}">[[${ p }]]</a></li>
			            <li class="page-item">
			            	<a class="page-link" th:href="@{${loc}(page=${pi.currentPage+1})}" aria-label="Next">
			            		<span aria-hidden="true">&raquo;</span>
			            	</a>
			            </li>
			    	</ul>
			    </div>
			    <input type="hidden" id="path" name="path" value="memManager"/>
			</main>
		</div>
	</div>
	
	<script th:inline="javascript">
		const path = document.getElementById("path").value;
		
		document.getElementById("offBtn").addEventListener("click", function() {
	        // 체크된 체크박스를 가져옵니다.
	        const checkboxes = document.querySelectorAll('input[name="checked"]:checked');
	        const memberNumbers = [];
	
	        // 체크된 항목의 회원번호를 배열에 추가합니다.
	        checkboxes.forEach(function(checkbox) {
	            const row = checkbox.closest('tr');
	            const memNo = row.querySelector('input[name="memNo"]').value;
	            memberNumbers.push(memNo);
	        });
	
	        // 회원번호 배열이 비어있는지 확인합니다.
	        if (memberNumbers.length === 0) {
	            alert("비활성화할 계정을 선택하세요.");
	            return;
	        }
	
	        // 확인 알림창을 띄웁니다.
	        const confirmDeactivate = confirm("정말 비활성화 하시겠습니까?");
	        if (confirmDeactivate) {
	            location.href = "activeOff.adm?memberNumbers=" + memberNumbers + "&path=" + path + "&page=" + /*[[${pi.currentPage}]]*/1;
	        }
	    });
		
		document.getElementById("onBtn").addEventListener("click", function() {
	        // 체크된 체크박스를 가져옵니다.
	        const checkboxes = document.querySelectorAll('input[name="checked"]:checked');
	        const memberNumbers = [];
	
	        // 체크된 항목의 회원번호를 배열에 추가합니다.
	        checkboxes.forEach(function(checkbox) {
	            const row = checkbox.closest('tr');
	            const memNo = row.querySelector('input[name="memNo"]').value;
	            memberNumbers.push(memNo);
	        });
	
	        // 회원번호 배열이 비어있는지 확인합니다.
	        if (memberNumbers.length === 0) {
	            alert("활성화할 계정을 선택하세요.");
	            return;
	        }
	
	        // 확인 알림창을 띄웁니다.
	        const confirmDeactivate = confirm("정말 활성화 하시겠습니까?");
	        if (confirmDeactivate) {
	            location.href = "activeOn.adm?memberNumbers=" + memberNumbers + "&path=" + path + "&page=" + /*[[${pi.currentPage}]]*/1;
	        }
	    });
		
		document.getElementById("gradeChange").addEventListener("click", function() {
	        // 체크된 체크박스를 가져옵니다.
	        const checkboxes = document.querySelectorAll('input[name="checked"]:checked');
	        const memberNumbers = [];
	
	        // 체크된 항목의 회원번호를 배열에 추가합니다.
	        checkboxes.forEach(function(checkbox) {
	            const row = checkbox.closest('tr');
	            const memNo = row.querySelector('input[name="memNo"]').value;
	            memberNumbers.push(memNo);
	        });
	
	        // 회원번호 배열이 비어있는지 확인합니다.
	        if (memberNumbers.length === 0) {
	            alert("등급을 변경할 계정을 선택하세요.");
	            return;
	        }
	
	        // 확인 알림창을 띄웁니다.
	        const confirmDeactivate = confirm("정말 회원등급을 변경 하시겠습니까?");
	        if (confirmDeactivate) {
	            location.href = "changeGrade.adm?memberNumbers=" + memberNumbers + "&path=" + path + "&page=" + /*[[${pi.currentPage}]]*/1;
	        }
	    });
	</script>
</body>
</html>